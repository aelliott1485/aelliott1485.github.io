
<html>

    <head>
        <script src="//www.chartjs.org/dist/2.7.2/Chart.bundle.js"></script>
        <script src="//www.chartjs.org/samples/latest/utils.js"></script>
    </head>
    <body>
        <div style="width:75%;">
            <canvas id="canvas"></canvas>
        </div>
        <script type="text/javascript">
          const url = 'https://chat.stackexchange.com/search?q=%22RELOAD!+There+are%22&user=125580&room=8595&pagesize=150';
          const pUrl = 'https://cors-escape.herokuapp.com/' + url;
          fetch(pUrl).then(response => response.text()).then(html => {
            //console.log('html', html);
            const container = document.createElement('div');
	          container.style.display = 'none';
	          container.innerHTML = html;
            const timestamps = container.getElementsByClassName('timestamp');
	          const contents = container.getElementsByClassName('content'); 
            
            if(contents.length == timestamps.length) {
              let i = 0;
              const labels = [], data = [];
              for (contentElement of contents) {
                var matches = contentElement.innerHTML.match(/\d{2}.\d{4}/);
                if (matches.length) {
                  data.push(matches[0]);
                  labels.push(timestamps[i++].innerHTML);
                }
              }
              if (data.length) {
                drawChart(data, labels);
              }
            }
          });
          const drawChart = (data, labels) => {
            Chart.defaults.global.legend.display = false;
            const config = {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Unanswered Percentage',
                        backgroundColor: window.chartColors.red,
                        borderColor: window.chartColors.red,
                        data: data,
                        fill: false
                    }]
                },
                options: {
                    title: {
                        display: true,
                        text: 'Answered percentage in recent months'
                    },
                    scales: {
                        xAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'Date'
                            }
                        }],
                        yAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'Percentage'
                            }
                        }]
                    }
                }
            };
            document.addEventListener('DOMContentLoaded', _ => {
                var ctx = document.getElementById('canvas').getContext('2d');
                window.myLine = new Chart(ctx, config);
            });
          };
        </script>
    </body>

    </html>
